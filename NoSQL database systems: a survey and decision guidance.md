# NoSQL database systems: a survey and decision guidance

# 摘要
今天，数据正在以史无前例的规模被生成并且被消费。这种情况催生了面向持续增上的数据和请求的基于"NoSQL"的可扩展数据管理系统。但是，现有的系统的异构性和多样性使得在面对一个给定的应用上下文进行数据存储选型非常困难。因此，这篇文章从上层视角进行概括：我们并不打算深入对比每个系统的详细的实现特性，我们提供了一个  将功能和非功能的需求与NoSQL数据库中的技术和算法结合起来的比较分类模型。这个NoSQL工具箱使得我们可以根据一个简单的决策树来帮助从业者和研究者根据关键的应用需求过滤出潜在的备选系统。

# 1 介绍
通过几十年的发展，传统的关系型数据库管理系统(RDBMS) 对存储和查询结构化数据提供了涉及：`强一致、事务保证、很高级别的数据可靠性、稳定性等方面 `一套非常强悍的机制。近些年来，一些应用领域处理的有效的数量量已经变得如此巨大以至于通过创痛的数据库方案无法被存储以及处理。社交网络中的用户生成内容，大型网络传感器采集的数据 仅仅是大数据的两个典型的样例。一类可以用来处理大数据的新型的数据存储系统被统一称为：NoSQL数据库，其中很多系统通过牺牲查询能力和一致性保障提供相比关系型数据库更好的水平可扩展和高可用能力。因为任何有状态服务只能和其底层的数据存储具有一样的可扩展和容错能力，这种折衷对于面向服务的计算和作为服务的模型来讲非常关键，

目前有数十个NoSQL数据库系统,由于实现细节变化很快并且系统特性也随着时间变化不断演进，这些系统很难分清出处理其各自适合什么场景? 怎么处理失败? 甚至他们有哪些不同。这篇文章中，我同通过面向应用概念而不是系统特性并且结合NoSQL数据系统的自身需求、实现这些需求的技术需求以及过程中的折衷来对NoSQL的格局进行一个概要展示。我们主要聚焦在：`key-value，文档和宽-列存储`，这几种存储NoSQL类别从数据可扩展性管理上已经覆盖了绝大多数相关技术和设计决策。

第2部分，我们通过key-value存储、文档存储、宽-列存储等存储模型以及设计思想（CAP 以及PACELC）上safety-liveness的折衷两个维度来对NoSQL数据库系统进行分类来提供一种通用分类。
然后在第3部分我们更详细的调研使用到的技术并且描述需求如何和技术相关联。
第4部分通过应用我们的模型我们给出了一个数据库系统核心特征的广泛概述。
最终第5部分总结出根据应用需求来选择合适的NoSQL系统的一个简单和抽象的决策模型。

# 2 整体系统分类
为了对不同的NoSQL系统实现细节进行抽象，我们使用整体分类标准将数据存储分门别类。这一部分，我们使用两个主要分类标准：数据模型 以及 CAP理论。

## 2.1 数据模型分类标准
### 2.1.1  key-value 存储
一个key-value存储包含一些列具有不同key值的key-value序对。由于这个简单的结构，系统只支持get和put操作。存储的数据相对数据库是透明的特性，纯粹的key-value存储不支持CRUD（create、read、update、delete）之外的其他操作。key-value存储因此被认为：没有语义模式（schemaless）：存储数据的结构默认由应用程序在上层进行编码(schema-on-read)并且无法通过一个数据定义语言显示定义（schema-on-write）。
```
思考：关键词：无模式、只支持CRUD操作、value为编码后字节流上层理解
目前见到的key-value形式的存储：
磁盘介质：tdb、tssd
内存介质：tair、dcache、redis
```

这种数据模型的显著的优势就是简单性。非常简单的抽象使得数据分区和查询非常容易，这样数据库系统也能实现低延迟和高吞吐。但是，如果应用需要更复杂的操作，比如：范围查询，这种数据模型将不再有效。表1展示用户账户数据和设置是如何在key-value存储系统中存储中。由于比简单查询更复杂的查询无法被支持。数据只能在应用层通过解码分析才能抽取出像：是否支持cookie这样的信息。
![key-value和document格式的nosql](https://github.com/sandszhouSZ/PaperTranslate/blob/EditBranch/image/Nosql-1-2.png)

### 2.1.2  文档存储
一个文档存储是一个value为半结构化（比如JSON）格式的文档类型的key-value存储。这种相比较原生的key-value的约束给访问数据带来很大的灵活性。应用不仅可以通过ID来获取全部的文档内容，而且可以只获取文档的的部分数据。比如：custor的年龄，并且可以执行聚合（计算技术、排序），query-by-example或者甚至是全文查找。
```
思考：关键词：value为半结构格式的key-value文档，用户的使用可扩展性更高，使用形式更灵活、贴近RDBMS。
目前使用到的存储：
mongoDB，ES搜索
```

###2.1.3 宽-列存储
宽列存储取名是从 `其经常被用于解释下面的数据模型：拥有很多稀疏列的一个关系表 `得来。但是，从技术上看一个宽-列存储和一个分布式的多层有序map非常类似(比如对于Bigtable：多层体现在：行、列、时间戳 -> data):第一层的key标识表中的row，被称为:行关键字，第二级的key被称为：列关键字。由于没有数据时就不会有列key，这种存储模式使得拥有任意多列非常容易。所以，null值可以不用花费任何开销进行存储。所有的列被分为称为：列族，同一列族的相关列一般都是同时访问，其可以存储在磁盘上临近位置。在磁盘上，宽-列存储并不能colocate每个行的所有数据而是colocate相同行相同列族的数据。所以，一个实体（row）在一个文档存储中不能只通过一次查找就能获取到。但是通过所有的列族的列聚合起来。但是，这种存储布局通常可以保证高度有效的数据压缩同时使得获取一个实体的一部分非常有效。数据通过key的字典序排序，所以通过自己的设计key值可以使得临近的数据的访问基本是物理上临近的。由于所有的行被分割为连续的范围（称为tablet）并且分布到不同的分片节点，行扫描一般只涉及很少的节点所以会非常高效。
```
思考： 关键词：有存储模式，具有为稀疏列的大表，多级key，压缩
目前使用到的存储:
Bigtable、HBase
```
![宽列存储](https://github.com/sandszhouSZ/PaperTranslate/blob/EditBranch/image/Nosql-wide-column.png)
Google为了存储大量网页特别开发Bigtable代表了宽-列存储模型，如图标3。网页表的每一行代表了一个特数据网页。行关键字是URL组件的反转级联组成，而且每个列关键字包含了：列族的名字和列通配符，其通过分好链接在一起。这里有两个列族：内容列族只包含一列用以存储真实的网页数据；anchor列族包含了到每个网页的连接，每个都是单独一列。表中的每个单元（行和列组合对应的数据）都可以通过时间戳或者版本号来被版本化。明确一个时间的多数信息不仅仅通过value而且是是通过key来表达。

## 22 一致性-可用性折衷：CAP 和 PACELC




